<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Stateless Models in PyTorch | Hamed Hemati </title> <meta name="author" content="Hamed Hemati"> <meta name="description" content=""> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://hamedhemati.github.io/blog/2023/tabs/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Hamed</span> Hemati </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Stateless Models in PyTorch</h1> <p class="post-meta"> Created in August 12, 2023 </p> <p class="post-tags"> <a href="/blog/2023"> <i class="fa-solid fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/tag/pytorch"> <i class="fa-solid fa-hashtag fa-sm"></i> pytorch</a>   <a href="/blog/tag/machine-learning"> <i class="fa-solid fa-hashtag fa-sm"></i> machine_learning</a>   ·   <a href="/blog/category/programming"> <i class="fa-solid fa-tag fa-sm"></i> programming</a>   <a href="/blog/category/machine-learning"> <i class="fa-solid fa-tag fa-sm"></i> machine_learning</a> </p> </header> <article class="post-content"> <div id="table-of-contents"> <ul id="toc" class="section-nav"> <li class="toc-entry toc-h2"> <a href="#what-are-stateful-and-stateless-models">What are Stateful and Stateless Models?</a> <ul> <li class="toc-entry toc-h5"><a href="#ambiguity">Ambiguity</a></li> </ul> </li> <li class="toc-entry toc-h2"> <a href="#when-to-use-which">When to Use Which?</a> <ul> <li class="toc-entry toc-h5"><a href="#tldr">TLDR</a></li> <li class="toc-entry toc-h3"><a href="#examples">Examples</a></li> </ul> </li> <li class="toc-entry toc-h2"><a href="#stateless-models-in-pytorch">Stateless Models in PyTorch</a></li> </ul> </div> <hr> <div id="markdown-content"> <p>In the realm of deep learning libraries, the topic of <em>state representation</em> of a model becomes crucial in certain problems. Broadly speaking, there are two widely used state representation methods: <strong>stateful</strong> and <strong>stateless</strong>.</p> <p>In this article, I’ll briefly introduce the concept and demonstrate through examples when to use which method when implementing a solution in PyTorch. Some topics related to this article are:</p> <ul> <li>Meta-learning</li> <li>Hypernetworks</li> <li>Ensemble Modelling</li> </ul> <h2 id="what-are-stateful-and-stateless-models">What are Stateful and Stateless Models?</h2> <hr> <p>Getting straight to the point, in PyTorch, the two state representations are defined as follows:</p> <p><strong>Stateful Models</strong> are models whose state (aka the model’s weights) is defined and stored inside the model class definition. When you create an instance of the model, it initializes the wieghts internally. <u>By default, PyTorch models are stateful</u>. Below is an example of a stateful MLP with one hidden layer:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">torch.nn</span> <span class="k">as</span> <span class="n">nn</span>

<span class="k">class</span> <span class="nc">StatefulModel</span><span class="p">(</span><span class="n">nn</span><span class="p">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">output_dim</span><span class="p">):</span>
        <span class="nf">super</span><span class="p">(</span><span class="n">StatefulModel</span><span class="p">,</span> <span class="n">self</span><span class="p">).</span><span class="nf">__init__</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="nc">Linear</span><span class="p">(</span><span class="n">input_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="nc">Linear</span><span class="p">(</span><span class="n">hidden_dim</span><span class="p">,</span> <span class="n">output_dim</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">relu</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="nf">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">fc2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>

<span class="c1"># Initialize model
</span><span class="n">model</span> <span class="o">=</span> <span class="nc">StatefulModel</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Initialize a random input
</span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># Make prediction
</span><span class="n">pred</span> <span class="o">=</span> <span class="nf">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></div> <p>In the example, the layers are defined as the module attributes of the class, specifically of type <code class="language-plaintext highlighter-rouge">nn.Linear</code>. The definition of each layer contains the set of operations needed for forward propagation and also maintains the state for that layer. As a results, the entire model posseses its complete state which can be access via <code class="language-plaintext highlighter-rouge">model.state_dict()</code>. In Pytorch, model’s weights are stored as an <code class="language-plaintext highlighter-rouge">Ordered Dictionary</code>.</p> <p><strong>Stateless Models</strong>, on the other hand, do not store weights internally. Instead, the weights are passed as input. The example below shows a stateless definition of a model in PyTorch:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">torch.nn</span> <span class="k">as</span> <span class="n">nn</span>
<span class="kn">import</span> <span class="n">torch.nn.functional</span> <span class="k">as</span> <span class="n">F</span>

<span class="k">class</span> <span class="nc">StatelessModel</span><span class="p">(</span><span class="n">nn</span><span class="p">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="p">.</span><span class="nf">relu</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="nf">linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weights</span><span class="p">[</span><span class="sh">'</span><span class="s">fc1.weight</span><span class="sh">'</span><span class="p">],</span> <span class="n">weights</span><span class="p">[</span><span class="sh">'</span><span class="s">fc1.bias</span><span class="sh">'</span><span class="p">]))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="p">.</span><span class="nf">linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weights</span><span class="p">[</span><span class="sh">'</span><span class="s">fc2.weight</span><span class="sh">'</span><span class="p">],</span> <span class="n">weights</span><span class="p">[</span><span class="sh">'</span><span class="s">fc2.bias</span><span class="sh">'</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">x</span>



<span class="c1"># Initialize model
</span><span class="n">model</span> <span class="o">=</span> <span class="nc">StatelessModel</span><span class="p">()</span>

<span class="c1"># Initialize weights
</span><span class="n">weights</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">fc1.weight</span><span class="sh">'</span><span class="p">:</span> <span class="n">torch</span><span class="p">.</span><span class="nf">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="sh">'</span><span class="s">fc1.bias</span><span class="sh">'</span><span class="p">:</span> <span class="n">torch</span><span class="p">.</span><span class="nf">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
    <span class="sh">'</span><span class="s">fc2.weight</span><span class="sh">'</span><span class="p">:</span> <span class="n">torch</span><span class="p">.</span><span class="nf">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
    <span class="sh">'</span><span class="s">fc2.bias</span><span class="sh">'</span><span class="p">:</span> <span class="n">torch</span><span class="p">.</span><span class="nf">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Initialize random input
</span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># Make prediction
</span><span class="n">pred</span> <span class="o">=</span> <span class="nf">model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
</code></pre></div></div> <p>As you can see, in the stateless version, there are no module initializations when creating an instance of the class. Instead, the class only defines the forward function that instructs how an input should be mapped to an output through a set of ternsor operations.</p> <blockquote class="block-warning"> <h5 id="ambiguity">Ambiguity</h5> <p>In the context of Recurrent Neural Networks (RNNs), the terms “stateful” and “stateless” can take on a different meaning, and refer to <u> the way the hidden state of the RNN is initialized</u> . In a stateful RNN, the hidden state is carried over from the previous step. In contrast, a stateless RNN (randomly) re-initializes the hidden state at each step.</p> </blockquote> <h2 id="when-to-use-which">When to Use Which?</h2> <hr> <blockquote class="block-tip"> <h5 id="tldr">TLDR</h5> <p>“Stateless” models can be used for any type of problem, but they require manual management of the state and often involve more implementation effort. “Stateful” models are easier to implement, but can make life of a researcher or programmer harder in certain use cases.</p> </blockquote> <p>Some libraries like <a href="https://flax.readthedocs.io/en/latest/" rel="external nofollow noopener" target="_blank">Flax</a> (JAX+Flax) assume a stateless model definition by default, while in PyTorch standard model definitions are stateful. In general, if your problem has the “standard” training loop as below:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>REPEAT:
    - get data batch
    - forward an input to the model
    - compute loss and backpropagate
    - update weights
</code></pre></div></div> <p>then you’re probably better of choosing the stateful option. In most instances, stateful versions are more convenient because everything is handled as an all-in-one package.</p> <h3 id="examples">Examples</h3> <p>Despite their user-friendliness, stateful models can be problematic in certain situations. I’ve listed some of these situations, with an illustration for each, below:</p> <blockquote> <p>When weights of the model are generated by another model, or when the weights are perturbed or changed by an external modifier.</p> </blockquote> <p>A popular example is the <a href="https://arxiv.org/abs/1609.09106" rel="external nofollow noopener" target="_blank">hypernetwork</a>. Hypernetworks generate the weights of another network, usually referred to as the “main model”. The main model cannot maintain its state, instead, it receives it as an input provided by the output of the hypernetwork.</p> <div class="text-center"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2023-08-12-stateless_models/hypernet.png" sizes="95vw"></source> <img src="/assets/img/posts/2023-08-12-stateless_models/hypernet.png" class="img-fluid rounded z-depth-1" width="300" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <blockquote> <p>When the graph of the optimization process has to be maintained.</p> </blockquote> <p>Usually, in the inner loop of meta-optimization methods, we need to keep the computation graph throughout the entire optimization process. To acheive this, the state of the model cannot be stored internally and it needs to be kept externally for reference.</p> <div class="text-center"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2023-08-12-stateless_models/meta_learning.png" sizes="95vw"></source> <img src="/assets/img/posts/2023-08-12-stateless_models/meta_learning.png" class="img-fluid rounded z-depth-1" width="400" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <blockquote> <p>Parallel inference in ensemble models.</p> </blockquote> <p>Althout its possible to perform inference in ensemble models with stateful version, having multiple copies of the same model for parallel inference can become costly. For example if we need to make prediction with hundreds of models, each with small purterbation applied to a reference model, it can be achieve in more a effcient way with stateless versions.</p> <div class="text-center"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2023-08-12-stateless_models/ensemble.png" sizes="95vw"></source> <img src="/assets/img/posts/2023-08-12-stateless_models/ensemble.png" class="img-fluid rounded z-depth-1" width="300" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h2 id="stateless-models-in-pytorch">Stateless Models in PyTorch</h2> <hr> <p>Before PyTorch 2.0, converting a stateful model to its stateless equivalent required rewriting the forward function using functionals. An alternative was to use packages such as <a href="https://github.com/pytorch/functorch" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">funchtorch</code></a> and <a href="https://github.com/facebookresearch/higher" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">higher</code></a> that facilitated this conversion through monkeypatching. Luckily, since version 2.0, there is not need for external modules. A stateful model can be <strong>called</strong> in a stateless manner using <code class="language-plaintext highlighter-rouge">torch.nn.utils.stateless.functional_call</code> as demonstrated in the following example.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">torch.nn.utils.statless</span> <span class="kn">import</span> <span class="n">functionall_call</span>

<span class="c1"># Using the StatefulModel definition in the first code example
# Initialize model
</span><span class="n">model</span> <span class="o">=</span> <span class="nc">StatefulModel</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Initialize random input
</span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># Get the state dict of the model
</span><span class="n">state_dict</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">state_dict</span><span class="p">()</span>

<span class="c1"># Stateless call
</span><span class="nf">functional_call</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">state_dict</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="c1"># Make prediction
</span><span class="n">pred</span> <span class="o">=</span> <span class="nf">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></div> <p>In the example, we don’t convert the model directly. Instead, we utilize the stateful version and call it in a stateless manner. This minor change in the function call can enable a cleaner implementation of methods, which previously relied on third-party libraries in a more intricate way.</p> </div> </article> <p class="mb-2" style="margin-top: 1.5rem !important">Subscribe to be notified of future articles:</p> <div class="newsletter-form-container"> <form class="newsletter-form" action="https://app.loops.so/api/newsletter-form/" method="POST" style="justify-content: flex-start"> <input class="newsletter-form-input" name="newsletter-form-input" type="email" placeholder="user@example.com" required=""> <button type="submit" class="newsletter-form-button" style="justify-content: flex-start"> subscribe </button> <button type="button" class="newsletter-loading-button" style="justify-content: flex-start"> Please wait... </button> </form> <div class="newsletter-success" style="justify-content: flex-start"> <p class="newsletter-success-message">You're subscribed!</p> </div> <div class="newsletter-error" style="justify-content: flex-start"> <p class="newsletter-error-message">Oops! Something went wrong, please try again</p> </div> <button class="newsletter-back-button" type="button" onmouseout='this.style.textDecoration="none"' onmouseover='this.style.textDecoration="underline"'> ← Back </button> </div> <script>function submitHandler(e){e.preventDefault();var t=e.target.parentNode,r=t.querySelector(".newsletter-form"),s=t.querySelector(".newsletter-form-input"),l=t.querySelector(".newsletter-success"),n=t.querySelector(".newsletter-error"),o=t.querySelector(".newsletter-error-message"),a=t.querySelector(".newsletter-back-button"),i=t.querySelector(".newsletter-form-button"),y=t.querySelector(".newsletter-loading-button");const d=()=>{n.style.display="flex",o.innerText="Too many signups, please try again in a little while",i.style.display="none",s.style.display="none",a.style.display="block"};var m=(new Date).valueOf(),c=localStorage.getItem("loops-form-timestamp");if(c&&Number(c)+6e4>m)d();else{localStorage.setItem("loops-form-timestamp",m),i.style.display="none",y.style.display="flex";var u="userGroup=&email="+encodeURIComponent(s.value);fetch(e.target.action,{method:"POST",body:u,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(e=>[e.ok,e.json(),e]).then(([e,t,s])=>{e?(l.style.display="flex",r.reset()):t.then(e=>{n.style.display="flex",o.innerText=e.message?e.message:s.statusText})})["catch"](e=>{"Failed to fetch"!==e.message?(n.style.display="flex",e.message&&(o.innerText=e.message),localStorage.setItem("loops-form-timestamp","")):d()})["finally"](()=>{s.style.display="none",y.style.display="none",a.style.display="block"})}}function resetFormHandler(e){var t=e.target.parentNode,r=t.querySelector(".newsletter-form-input"),s=t.querySelector(".newsletter-success"),l=t.querySelector(".newsletter-error"),n=t.querySelector(".newsletter-error-message"),o=t.querySelector(".newsletter-back-button"),a=t.querySelector(".newsletter-form-button");s.style.display="none",l.style.display="none",n.innerText="Oops! Something went wrong, please try again",o.style.display="none",r.style.display="flex",a.style.display="flex"}for(var formContainers=document.getElementsByClassName("newsletter-form-container"),i=0;i<formContainers.length;i++){var formContainer=formContainers[i],handlersAdded=formContainer.classList.contains("newsletter-handlers-added");handlersAdded||(formContainer.querySelector(".newsletter-form").addEventListener("submit",submitHandler),formContainer.querySelector(".newsletter-back-button").addEventListener("click",resetFormHandler),formContainer.classList.add("newsletter-handlers-added"))}</script> <noscript> <style>.newsletter-form-container{display:none}</style> </noscript> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Hamed Hemati. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"about",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-blog",title:"blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-publications",title:"publications",description:"publications by categories in reversed chronological order. generated by jekyll-scholar.",section:"Navigation",handler:()=>{window.location.href="/publications/"}},{id:"nav-projects",title:"projects",description:"A growing collection of your cool projects.",section:"Navigation",handler:()=>{window.location.href="/projects/"}},{id:"post-stateless-models-in-pytorch",title:"Stateless Models in PyTorch",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2023/tabs/"}},{id:"news-i-will-be-challenge-chair-at-the-clvision-2023-https-sites-google-com-view-clvision2023-organizers-workshop",title:"I will be challenge chair at the [CLVision 2023](https://sites.google.com/view/clvision2023/organizers) workshop",description:"",section:"News"},{id:"news-two-papers-accepted-at-collas-2023",title:"Two papers accepted at CoLLAs-2023",description:"",section:"News",handler:()=>{window.location.href="/news/announcement_2023_collas/"}},{id:"news-avalanche-has-been-accepted-by-jmlr-machine-learning-open-source-software",title:"Avalanche has been accepted by JMLR - Machine Learning Open Source Software",description:"",section:"News",handler:()=>{window.location.href="/news/announcement_2023_jmlr/"}},{id:"news-i-will-be-challenge-chair-at-the-clvision-2024-https-sites-google-com-view-clvision2024-organizers-workshop",title:"I will be challenge chair at the [CLVision 2024](https://sites.google.com/view/clvision2024/organizers) workshop",description:"",section:"News"},{id:"news-clvision-challenge-report-is-published-in-elsevier-39-s-neural-networks",title:"CLVision challenge report is published in Elsevier&#39;s Neural Networks",description:"",section:"News",handler:()=>{window.location.href="/news/announcement_2024_neuralnets/"}},{id:"projects-vocally-yours",title:"Vocally Yours",description:"Neural Text-to-Speech",section:"Projects",handler:()=>{window.location.href="/projects/vocally_yours/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%68%65%6D%61%74%69.%68%6D%64@%67%6D%61%69%6C.%63%6F%6D","_blank")}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=IVJi7QgAAAAJ","_blank")}},{id:"socials-github",title:"GitHub",section:"Socials",handler:()=>{window.open("https://github.com/HamedHemati","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>